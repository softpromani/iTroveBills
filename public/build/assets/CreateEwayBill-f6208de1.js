import{T as M,o as p,c,a,u as o,w as D,F as k,Z as C,b as e,d as b,t as r,f as O,x as U,e as F,h as d,k as v,Y as _,i as q,n as L,y as R,N as W}from"./app-52e465e7.js";import{_ as A}from"./AuthenticatedLayout-1e7b8b34.js";import{_ as G}from"./PrimaryButton-a0bc2ce3.js";import{_ as m}from"./InputError-27c18983.js";import{S as u}from"./sweetalert2.esm.all-263d9c0b.js";import{_ as K}from"./_plugin-vue_export-helper-c27b6911.js";import"./FlashMessages-6f9fe927.js";const $={class:"container-fluid p-4"},j={class:"card shadow-sm border-0 rounded-lg"},z={class:"card-body p-4"},H={class:"row"},J={class:"col-md-4 border-right"},Q={class:"mb-3"},Y={class:"font-weight-bold d-flex align-items-center"},Z={key:0,class:"ml-2 badge badge-warning",style:{"font-size":"10px"},title:"NIC portal allows max 16 chars. This will be automatically shortened."},X={class:"mb-3"},ee={class:"font-weight-bold"},te={class:"mb-3"},se={class:"font-weight-bold"},oe={class:"small text-muted"},le={class:"mb-3"},ie={class:"font-weight-bold"},ne={class:"small text-muted"},ae={class:"mb-3"},re={class:"font-weight-bold text-success"},de={class:"mt-4"},me={class:"text-muted mb-2"},ue={class:"table-responsive"},pe={class:"table table-sm small"},ce={class:"text-truncate",style:{"max-width":"100px"}},be={class:"col-md-8"},ve={class:"row"},fe={class:"col-md-6 mb-3"},ye={class:"col-md-6 mb-3"},ge={class:"row"},we={class:"col-md-6 mb-3"},xe={class:"col-md-6 mb-3"},he={class:"row"},_e={class:"col-md-6 mb-3"},De={class:"col-md-6 mb-3"},Te={class:"row"},Se={class:"col-md-6 mb-3"},Ne=["required"],Ie={class:"col-md-6 mb-3"},Be={class:"row mt-4"},Ve={class:"col-md-6 mb-3"},ke={class:"col-md-6 mb-3"},Pe={class:"mt-4 pt-3 border-top d-flex justify-content-between"},Ee={key:0},Me={key:1},Ce={__name:"CreateEwayBill",props:{invoice:Object,invoice_type:String},setup(n){var S,N;const f=n,s=M({invoice_id:f.invoice.id,supplyType:"O",subSupplyType:"1",subSupplyDesc:"",fromPincode:((S=f.invoice.company)==null?void 0:S.pin)||"",toPincode:((N=f.invoice.customer)==null?void 0:N.pin)||"",transMode:"1",transDistance:"",vehicleNo:f.invoice.vehicle_no||"",vehicleType:"R",transporterName:"",transporterId:"",transDocNo:"",transDocDate:"",transactionType:1,invoice_type:f.invoice_type}),P=()=>{if(s.transDistance>4e3){u.fire({icon:"warning",title:"Invalid Distance",text:"Distance cannot exceed 4000 KM for a single E-Way Bill."});return}u.fire({title:"Generating E-Way Bill...",text:"Please wait while we connect to the portal",allowOutsideClick:!1,didOpen:()=>{u.showLoading()}}),R.post(route("generate.eway.bill"),s.data()).then(i=>{u.close(),i.data.status===1&&u.fire({icon:"success",title:"Success!",text:i.data.message,confirmButtonText:"View List"}).then(()=>{W.get(route("invoice.list"))})}).catch(i=>{var g,w,x,h,l,I,B,V;u.close();const t=((w=(g=i.response)==null?void 0:g.data)==null?void 0:w.message)||"Something went wrong while generating the E-Way Bill",y=((I=(l=(h=(x=i.response)==null?void 0:x.data)==null?void 0:h.details)==null?void 0:l.error)==null?void 0:I.message)||"";u.fire({icon:"error",title:"Generation Failed",html:`<div>${t}</div>${y?`<div class="mt-2 small text-danger"><b>API Detail:</b> ${y}</div>`:""}`}),(V=(B=i.response)==null?void 0:B.data)!=null&&V.errors&&s.setErrors(i.response.data.errors)})},E=i=>i?new Date(i).toLocaleDateString("en-IN"):"",T=i=>parseFloat(i||0).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2});return(i,t)=>(p(),c(k,null,[a(o(C),{title:"Generate E-Way Bill"}),a(A,null,{default:D(()=>{var y,g,w,x,h;return[e("div",$,[e("div",j,[t[38]||(t[38]=e("div",{class:"bg-purple-700 text-white py-2 px-3 rounded-t-lg position-relative"},[e("h4",{class:"text-sm mb-0 text-center uppercase font-weight-bold"},[e("i",{class:"fa fa-truck mr-2"}),b(" Generate E-Way Bill")])],-1)),e("div",z,[e("div",H,[e("div",J,[t[17]||(t[17]=e("h5",{class:"text-secondary mb-4 border-bottom pb-2"},"Invoice Details",-1)),e("div",Q,[t[11]||(t[11]=e("label",{class:"text-muted small d-block mb-1"},"Invoice Number",-1)),e("div",Y,[b(r(n.invoice.invoice_number)+" ",1),n.invoice.invoice_number.length>16?(p(),c("span",Z,[...t[10]||(t[10]=[e("i",{class:"fa fa-exclamation-triangle"},null,-1),b(" >16 Chars ",-1)])])):O("",!0)])]),e("div",X,[t[12]||(t[12]=e("label",{class:"text-muted small d-block mb-1"},"Invoice Date",-1)),e("div",ee,r(E(n.invoice.invoice_date)),1)]),e("div",te,[t[13]||(t[13]=e("label",{class:"text-muted small d-block mb-1"},"Seller",-1)),e("div",se,r((y=n.invoice.company)==null?void 0:y.company_name),1),e("div",oe,r((g=n.invoice.company)==null?void 0:g.gstin),1)]),e("div",le,[t[14]||(t[14]=e("label",{class:"text-muted small d-block mb-1"},"Buyer",-1)),e("div",ie,r((w=n.invoice.customer)==null?void 0:w.company_name),1),e("div",ne,r((x=n.invoice.customer)==null?void 0:x.gstin),1)]),e("div",ae,[t[15]||(t[15]=e("label",{class:"text-muted small d-block mb-1"},"Total Amount",-1)),e("div",re,"â‚¹ "+r(T(n.invoice.subtotal_amount||n.invoice.total_ammount)),1)]),e("div",de,[e("h6",me,"Items ("+r((h=n.invoice.items)==null?void 0:h.length)+")",1),e("div",ue,[e("table",pe,[t[16]||(t[16]=e("thead",null,[e("tr",null,[e("th",null,"Item"),e("th",null,"Qty"),e("th",null,"Amount")])],-1)),e("tbody",null,[(p(!0),c(k,null,U(n.invoice.items,l=>(p(),c("tr",{key:l.id},[e("td",ce,r(l.desc_product),1),e("td",null,r(l.quantity),1),e("td",null,r(T(l.subtotal_amount||l.rate*l.quantity)),1)]))),128))])])])])]),e("div",be,[e("form",{onSubmit:F(P,["prevent"])},[t[37]||(t[37]=e("h5",{class:"text-secondary mb-4 border-bottom pb-2"},"Transport & Supply Details",-1)),e("div",ve,[e("div",fe,[t[18]||(t[18]=e("label",{class:"font-weight-bold"},"From Pincode (Seller)",-1)),d(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=l=>o(s).fromPincode=l),class:"form-control",placeholder:"6-digit Pincode",maxlength:"6",required:""},null,512),[[v,o(s).fromPincode]]),a(m,{message:o(s).errors.fromPincode},null,8,["message"])]),e("div",ye,[t[19]||(t[19]=e("label",{class:"font-weight-bold"},"To Pincode (Buyer)",-1)),d(e("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=l=>o(s).toPincode=l),class:"form-control",placeholder:"6-digit Pincode",maxlength:"6",required:""},null,512),[[v,o(s).toPincode]]),a(m,{message:o(s).errors.toPincode},null,8,["message"])])]),e("div",ge,[e("div",we,[t[21]||(t[21]=e("label",{class:"font-weight-bold"},"Supply Type",-1)),d(e("select",{"onUpdate:modelValue":t[2]||(t[2]=l=>o(s).supplyType=l),class:"form-control"},[...t[20]||(t[20]=[e("option",{value:"O"},"Outward",-1),e("option",{value:"I"},"Inward",-1)])],512),[[_,o(s).supplyType]]),a(m,{message:o(s).errors.supplyType},null,8,["message"])]),e("div",xe,[t[23]||(t[23]=e("label",{class:"font-weight-bold"},"Sub Supply Type",-1)),d(e("select",{"onUpdate:modelValue":t[3]||(t[3]=l=>o(s).subSupplyType=l),class:"form-control"},[...t[22]||(t[22]=[e("option",{value:"1"},"Supply",-1),e("option",{value:"2"},"Import",-1),e("option",{value:"3"},"Export",-1),e("option",{value:"4"},"Job Work",-1),e("option",{value:"5"},"For Own Use",-1),e("option",{value:"6"},"SKD/CKD",-1),e("option",{value:"7"},"Recipient Not Known",-1),e("option",{value:"8"},"Exhibition or Fairs",-1),e("option",{value:"9"},"Line Sales",-1),e("option",{value:"10"},"Others",-1)])],512),[[_,o(s).subSupplyType]]),a(m,{message:o(s).errors.subSupplyType},null,8,["message"])])]),e("div",he,[e("div",_e,[t[25]||(t[25]=e("label",{class:"font-weight-bold"},"Transport Mode",-1)),d(e("select",{"onUpdate:modelValue":t[4]||(t[4]=l=>o(s).transMode=l),class:"form-control"},[...t[24]||(t[24]=[e("option",{value:"1"},"Road",-1),e("option",{value:"2"},"Rail",-1),e("option",{value:"3"},"Air",-1),e("option",{value:"4"},"Ship",-1)])],512),[[_,o(s).transMode]]),a(m,{message:o(s).errors.transMode},null,8,["message"])]),e("div",De,[t[26]||(t[26]=e("label",{class:"font-weight-bold"},"Distance (approx. KM)",-1)),d(e("input",{type:"number","onUpdate:modelValue":t[5]||(t[5]=l=>o(s).transDistance=l),class:"form-control",placeholder:"Distance in Km",required:""},null,512),[[v,o(s).transDistance]]),a(m,{message:o(s).errors.transDistance},null,8,["message"])])]),e("div",Te,[e("div",Se,[t[27]||(t[27]=e("label",{class:"font-weight-bold"},"Vehicle Number",-1)),d(e("input",{type:"text","onUpdate:modelValue":t[6]||(t[6]=l=>o(s).vehicleNo=l),class:"form-control",placeholder:"e.g. MH01AB1234",required:o(s).transMode=="1"},null,8,Ne),[[v,o(s).vehicleNo]]),t[28]||(t[28]=e("small",{class:"text-muted"},"Mandatory for Road transport",-1)),a(m,{message:o(s).errors.vehicleNo},null,8,["message"])]),e("div",Ie,[t[30]||(t[30]=e("label",{class:"font-weight-bold"},"Vehicle Type",-1)),d(e("select",{"onUpdate:modelValue":t[7]||(t[7]=l=>o(s).vehicleType=l),class:"form-control"},[...t[29]||(t[29]=[e("option",{value:"R"},"Regular",-1),e("option",{value:"O"},"Over Dimensional Cargo",-1)])],512),[[_,o(s).vehicleType]]),a(m,{message:o(s).errors.vehicleType},null,8,["message"])])]),e("div",Be,[t[33]||(t[33]=e("div",{class:"col-12"},[e("h6",{class:"text-muted mb-3 border-bottom pb-1"},"Optional Transporter Info")],-1)),e("div",Ve,[t[31]||(t[31]=e("label",null,"Transporter Name",-1)),d(e("input",{type:"text","onUpdate:modelValue":t[8]||(t[8]=l=>o(s).transporterName=l),class:"form-control"},null,512),[[v,o(s).transporterName]])]),e("div",ke,[t[32]||(t[32]=e("label",null,"Transporter ID",-1)),d(e("input",{type:"text","onUpdate:modelValue":t[9]||(t[9]=l=>o(s).transporterId=l),class:"form-control"},null,512),[[v,o(s).transporterId]])])]),e("div",Pe,[a(o(q),{href:i.route("invoice.list"),class:"btn btn-outline-secondary"},{default:D(()=>[...t[34]||(t[34]=[e("i",{class:"fa fa-arrow-left"},null,-1),b(" Back to List ",-1)])]),_:1},8,["href"]),a(G,{class:L({"opacity-25":o(s).processing}),disabled:o(s).processing},{default:D(()=>[o(s).processing?(p(),c("span",Ee,[...t[35]||(t[35]=[e("i",{class:"fa fa-spinner fa-spin mr-1"},null,-1),b(" Generating...",-1)])])):(p(),c("span",Me,[...t[36]||(t[36]=[e("i",{class:"fa fa-paper-plane mr-1"},null,-1),b(" Generate E-Way Bill",-1)])]))]),_:1},8,["class","disabled"])])],32)])])])])])]}),_:1})],64))}},Ae=K(Ce,[["__scopeId","data-v-fd1aae38"]]);export{Ae as default};
