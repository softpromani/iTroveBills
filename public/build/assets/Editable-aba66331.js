import{T as q,p as d,o as r,c,b as l,a as W,w as O,q as w,F as h,x as E,t as p,d as z,f as N,y as A}from"./app-0f33a5d4.js";import{_ as M}from"./_plugin-vue_export-helper-c27b6911.js";const L={key:0},P={class:"-mt-4 rounded-lg shadow table-responsive"},Q={class:"table table-bordered"},U=["onInput"],j={class:"position-relative"},G=["value","onInput","onFocus","onBlur"],J={key:0,class:"dropdown-menu show position-absolute w-100",style:{top:"100%","z-index":"1000","max-height":"200px","overflow-y":"auto"}},X=["onMousedown"],Y=["onInput"],Z=["onInput"],x=["onInput"],I=["onInput"],tt=["onClick"],et=["onClick"],lt={class:"font-bold"},ot={class:"font-bold"},nt={__name:"Editable",setup(st){const B=q({}),a=d([["","","","","",""]]),y=d([]),f=d(!0),u=d({}),i=d({}),b=d(null),S=()=>{f.value=!f.value},v=(o,t,s)=>{let n=s.target.innerText;[2,4,5].includes(t)&&(n=parseFloat(n),isNaN(n)&&(n=0)),a.value[o][t]=n},V=async(o,t)=>{const s=t.target.value;if(a.value[o][1]=s,b.value&&clearTimeout(b.value),!s.trim()){i.value[o]=!1,u.value[o]=[];return}b.value=setTimeout(async()=>{try{const n=await A.get("/hsn/search",{params:{q:s}});u.value[o]=n.data,i.value[o]=!0}catch(n){console.error("Error searching HSN codes:",n),u.value[o]=[]}},300)},R=(o,t)=>{a.value[o][1]=t.code,i.value[o]=!1,u.value[o]=[]},H=o=>{setTimeout(()=>{i.value[o]=!1},150)},m=o=>{const t=window.getSelection();if(!t.rangeCount)return;const s=t.getRangeAt(0);o.target.dataset.cursorStart=s.startOffset},D=o=>{const t=["","","","","",""];a.value.splice(o+1,0,t)},K=o=>{if(a.value.length>1){a.value.splice(o,1),delete u.value[o],delete i.value[o];const t={},s={};a.value.forEach((n,e)=>{u.value[e+(e>=o?1:0)]&&(t[e]=u.value[e+(e>=o?1:0)]),i.value[e+(e>=o?1:0)]&&(s[e]=i.value[e+(e>=o?1:0)])}),u.value=t,i.value=s}},_=o=>{const t=parseFloat(a.value[o][2])||0,s=parseFloat(a.value[o][5])||0;return(t*s).toFixed(2)},C=()=>a.value.reduce((o,t,s)=>o+parseFloat(_(s)),0).toFixed(2),T=()=>a.value.reduce((o,t)=>o+(parseFloat(t[4])||0),0).toFixed(2),$=()=>{var e,g,k,F;const o=((e=document.getElementById("invoice_no"))==null?void 0:e.value)||"",t=((g=document.getElementById("customer"))==null?void 0:g.value)||"",s=((k=document.getElementById("company"))==null?void 0:k.value)||"",n=((F=document.getElementById("vehical_no"))==null?void 0:F.value)||"";y.value[0]={invoice:o,customer:t,company:s,vehical_no:n,totalWeight:T(),totalTaxableValue:C()},B.post(route("performa.customer.store.bill",{invoicedata:a.value,invoicedetails:y.value}),{preserveScroll:!0})};return(o,t)=>(r(),c(h,null,[l("div",{class:"mt-5 bg-purple-700 rounded-md position-relative"},[t[6]||(t[6]=l("h2",{class:"font-medium text-center text-white font-weight-bolder"}," INVOICE ",-1)),l("span",{class:"text-white cursor-pointer top-2 right-2 position-absolute",onClick:S},[...t[5]||(t[5]=[l("i",{class:"fa-solid fa-bullseye"},null,-1)])])]),W(w,{name:"slide-fade"},{default:O(()=>[f.value?(r(),c("div",L,[l("div",P,[l("table",Q,[t[13]||(t[13]=l("thead",{class:"table-dark"},[l("tr",null,[l("th",null,"S.NO."),l("th",null,"Description of Product"),l("th",null,"HSN Code"),l("th",null,"Quantity"),l("th",null,"Unit"),l("th",null,"Weight"),l("th",null,"Rate"),l("th",null,"Taxable Value"),l("th",null,"Action")])],-1)),l("tbody",null,[(r(!0),c(h,null,E(a.value,(s,n)=>(r(),c("tr",{key:n},[l("td",null,p(n+1),1),l("td",{contenteditable:"",onInput:e=>v(n,0,e),onKeydown:t[0]||(t[0]=e=>m(e))},null,40,U),l("td",j,[l("input",{type:"text",value:s[1],onInput:e=>V(n,e),onFocus:e=>i.value[n]=!0,onBlur:e=>H(n),class:"form-control border-0 p-1",placeholder:"Enter HSN Code",autocomplete:"off"},null,40,G),i.value[n]&&u.value[n]&&u.value[n].length>0?(r(),c("div",J,[(r(!0),c(h,null,E(u.value[n],e=>(r(),c("div",{key:e.code,onMousedown:g=>R(n,e),class:"dropdown-item cursor-pointer hover-item",style:{"font-size":"12px",padding:"8px 12px"}},[l("strong",null,p(e.code),1),z(" - "+p(e.description),1)],40,X))),128))])):N("",!0)]),l("td",{contenteditable:"",onInput:e=>v(n,2,e),onKeydown:t[1]||(t[1]=e=>m(e))},null,40,Y),l("td",{contenteditable:"",onInput:e=>v(n,3,e),onKeydown:t[2]||(t[2]=e=>m(e))},null,40,Z),l("td",{contenteditable:"",onInput:e=>v(n,4,e),onKeydown:t[3]||(t[3]=e=>m(e))},null,40,x),l("td",{contenteditable:"",onInput:e=>v(n,5,e),onKeydown:t[4]||(t[4]=e=>m(e))},null,40,I),l("td",null,p(_(n)),1),l("td",null,[n===a.value.length-1?(r(),c("span",{key:0,class:"cursor-pointer badge rounded-pill text-bg-primary",onClick:e=>D(n)},[...t[7]||(t[7]=[l("i",{class:"fa fa-plus","aria-hidden":"true"},null,-1)])],8,tt)):(r(),c("span",{key:1,class:"cursor-pointer badge rounded-pill text-bg-danger",onClick:e=>K(n)},[...t[8]||(t[8]=[l("i",{class:"fa fa-minus","aria-hidden":"true"},null,-1)])],8,et))])]))),128)),l("tr",null,[t[9]||(t[9]=l("td",{colspan:"4"},null,-1)),t[10]||(t[10]=l("td",{class:"font-bold"},"Total Weight:",-1)),l("td",lt,p(T()),1),t[11]||(t[11]=l("td",{class:"font-bold"},"Total:",-1)),l("td",ot,p(C()),1),t[12]||(t[12]=l("td",null,null,-1))])])])]),l("button",{class:"text-white btn btn-info text-bold mt-3",onClick:$}," Submit ")])):N("",!0)]),_:1})],64))}},it=M(nt,[["__scopeId","data-v-4b4cc3fc"]]);export{it as default};
