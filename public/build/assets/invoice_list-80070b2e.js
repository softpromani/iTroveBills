import{T as j,p as s,o as a,c as n,a as f,u as V,w as B,F as E,Z as R,b as e,x as q,t as i,i as O,d as b,e as P,h as d,k as c,f as M,A as L,y as h}from"./app-83963e4d.js";import{_ as z}from"./AuthenticatedLayout-690e0c0a.js";/* empty css                                              */import{S as y}from"./sweetalert2.esm.all-263d9c0b.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./FlashMessages-3bba3d09.js";const G={class:"bg-white rounded-lg shadow"},J={class:"rounded-lg table-responsive"},Q={class:"table",style:{"min-height":"200px"}},W={class:"dropdown"},X={class:"dropdown-menu"},Y=["onClick"],ee=["onClick"],te={key:0,class:"modal fade show",style:{display:"block"},"aria-modal":"true",role:"dialog"},oe={class:"modal-dialog",role:"document"},le={class:"modal-content"},se={class:"modal-body"},ae={class:"form-group mb-3"},ne={class:"form-group mb-3"},ie={class:"form-group mb-3"},re={key:1,class:"modal-backdrop fade show"},de={key:2,class:"modal fade show",style:{display:"block"},"aria-modal":"true",role:"dialog"},ue={class:"modal-dialog",role:"document"},ce={class:"modal-content"},me={class:"modal-header"},pe={class:"modal-title"},ve={class:"modal-body"},fe={class:"mb-3"},be=["id","value"],he=["for"],ye={class:"form-group mb-3"},ge={class:"form-group mb-3"},ke={class:"form-group mb-3"},_e={key:3,class:"modal-backdrop fade show"},Me={__name:"invoice_list",props:{invoices:Object},setup(K){const A=K;j({});const g=s(!1),k=s(!1),m=s(""),p=s(""),v=s(""),u=s(null),T=s(""),_=s(""),w=s(""),x=s(""),C=s(""),$=s([]),D=s(A.invoices),I=l=>{g.value=!0,u.value=l;const t="proforma";h.get(`/api/fetch-invoice/${l}/${t}`).then(o=>{const r=o.data;m.value=r.no_packets||"",p.value=r.vehicle_no||"",v.value=r.dispatched_through||"",u.value=r.id||""}).catch(o=>{console.error("Error fetching invoice:",o)})},N=()=>{g.value=!1,m.value="",p.value="",v.value=""},F=()=>{h.post("/api/update-invoice-package",{no_packets:m.value,vehicle_no:p.value,dispatched_through:v.value,invoice_id:u.value,type:"proforma"}).then(l=>{console.log("Package updated successfully:",l.data),y.fire({title:"Success!",text:"Package updated successfully.",icon:"success",confirmButtonText:"OK"}).then(()=>{setTimeout(()=>{location.reload()},1e4)}),N(),location.reload()}).catch(l=>{console.error("Error updating package:",l),y.fire({title:"Error!",text:"There was an error updating the package.",icon:"error",confirmButtonText:"OK"})})},H=l=>{k.value=!0,u.value=l;const t="proforma";h.get(`/api/fetch-invoice/${l}/${t}`).then(o=>{T.value=o.data.invoice_number}),h.get("/api/fetch-payment-types").then(o=>{$.value=o.data}).catch(o=>{console.error("Error fetching payment types:",o)})},S=()=>{k.value=!1,T.value="",w.value="",_.value="",x.value="",C.value="",u.value=null},Z=()=>{h.post("/api/pay-bill",{payment_method_id:w.value,reference_no:_.value,amount:x.value,remark:C.value,invoice_id:u.value,type:"proforma"}).then(l=>{l.data.status==1?y.fire({title:"Success!",text:l.data.message,icon:"success",confirmButtonText:"OK"}).then(()=>{location.reload()}):y.fire({title:"Info!",text:l.data.message,icon:"warning",confirmButtonText:"OK"}),S()}).catch(l=>{console.error("Error paying bill:",l),y.fire({title:"Error!",text:"There was an error paying the bill.",icon:"error",confirmButtonText:"OK"})})};return(l,t)=>(a(),n(E,null,[f(V(R),{title:"Customer view"}),f(z,null,{default:B(()=>[t[27]||(t[27]=e("div",{class:"inline-flex w-full mb-4 overflow-hidden bg-white rounded-lg shadow-md"},[e("div",{class:"flex items-center justify-center w-12 bg-pink-800"},[e("svg",{class:"w-6 h-6 text-white fill-current",viewBox:"0 0 40 40",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M20 3.33331C10.8 3.33331 3.33337 10.8 3.33337 20C3.33337 29.2 10.8 36.6666 20 36.6666C29.2 36.6666 36.6667 29.2 36.6667 20C36.6667 10.8 29.2 3.33331 20 3.33331ZM21.6667 28.3333H18.3334V25H21.6667V28.3333ZM21.6667 21.6666H18.3334V11.6666H21.6667V21.6666Z"})])]),e("div",{class:"px-4 py-2 -mx-3"},[e("div",{class:"mx-3"},[e("span",{class:"font-semibold text-blue-500"},"Invoice List")])])],-1)),e("div",G,[e("div",J,[e("table",Q,[t[13]||(t[13]=e("thead",{class:"table-dark"},[e("tr",null,[e("th",{class:"col-1"},"Sr.no."),e("th",{class:"col-1"},"Invoice Number"),e("th",{class:"col-1"},"Invoice Date"),e("th",{class:"col-1"},"Total Amount"),e("th",{class:"col-1"},"Vehicle No"),e("th",{class:"col-1"},"No. Packets"),e("th",{class:"col-1"},"Customer"),e("th",{class:"col-1"},"Action")])],-1)),e("tbody",null,[(a(!0),n(E,null,q(D.value,(o,r)=>(a(),n("tr",{key:o.id},[e("td",null,i(r+1),1),e("td",null,i(o.invoice_number??""),1),e("td",null,i(o.invoice_date??""),1),e("td",null,i(o.total_ammount??""),1),e("td",null,i(o.vehicle_no??""),1),e("td",null,i(o.no_packets??"NO PACK"),1),e("td",null,i(o.customer.company_name??""),1),e("td",null,[e("div",W,[t[12]||(t[12]=e("span",{class:"p-2",style:{"font-size":"15px",cursor:"pointer"},"data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa fa-ellipsis-v"})],-1)),e("ul",X,[e("li",null,[f(V(O),{class:"dropdown-item",href:l.route("performa.customer.bill.edit"),method:"get",data:{invoice_id:o.id}},{default:B(()=>[...t[7]||(t[7]=[e("i",{class:"fa-solid fa-pen-to-square",style:{color:"blueviolet"}},null,-1),b(" Edit",-1)])]),_:2},1032,["href","data"])]),e("li",null,[f(V(O),{href:l.route("performa.view.invoice"),method:"get",data:{invoice_id:o.id},class:"dropdown-item"},{default:B(()=>[...t[8]||(t[8]=[e("i",{class:"fa fa-print","aria-hidden":"true",style:{color:"rgb(241, 12, 12)"}},null,-1),b(" Print",-1)])]),_:2},1032,["href","data"])]),e("li",null,[f(V(O),{class:"dropdown-item",href:l.route("performa.bill.sendmail"),method:"post",data:{invoice_id:o.id}},{default:B(()=>[...t[9]||(t[9]=[e("i",{class:"fa fa-envelope-square","aria-hidden":"true",style:{color:"rgb(245, 180, 0)"}},null,-1),b(" Mail ",-1)])]),_:2},1032,["href","data"])]),e("li",null,[e("a",{onClick:P(U=>I(o.id),["prevent"]),class:"dropdown-item",href:"#"},[...t[10]||(t[10]=[e("i",{class:"fa fa-car","aria-hidden":"true",style:{color:"rgb(245, 180, 0)"}},null,-1),b(" Package Update ",-1)])],8,Y)]),e("li",null,[e("a",{onClick:P(U=>H(o.id),["prevent"]),class:"dropdown-item",href:"#"},[...t[11]||(t[11]=[e("i",{class:"fa fa-inr","aria-hidden":"true",style:{color:"rgb(245, 180, 0)"}},null,-1),b(" Pay Bill ",-1)])],8,ee)])])])])]))),128))])])]),t[14]||(t[14]=e("div",{class:"flex flex-col items-center px-1 py-1 bg-white border-t xs:flex-row xs:justify-between"},null,-1))]),g.value?(a(),n("div",te,[e("div",oe,[e("div",le,[e("div",{class:"modal-header"},[t[16]||(t[16]=e("h5",{class:"modal-title"},"Update Package",-1)),e("button",{type:"button",class:"close",onClick:N},[...t[15]||(t[15]=[e("span",null,"×",-1)])])]),e("div",se,[e("form",{onSubmit:P(F,["prevent"])},[e("div",ae,[t[17]||(t[17]=e("label",{for:"no_packets"},"No. of Package",-1)),d(e("input",{type:"number",class:"form-control",id:"no_packets","onUpdate:modelValue":t[0]||(t[0]=o=>m.value=o),required:""},null,512),[[c,m.value]])]),e("div",ne,[t[18]||(t[18]=e("label",{for:"vehicle_no"},"Vehicle Number",-1)),d(e("input",{type:"text",class:"form-control",id:"vehicle_no","onUpdate:modelValue":t[1]||(t[1]=o=>p.value=o),required:""},null,512),[[c,p.value]])]),e("div",ie,[t[19]||(t[19]=e("label",{for:"dispatched_through"},"Dispatched Through",-1)),d(e("input",{type:"text",class:"form-control",id:"dispatched_through","onUpdate:modelValue":t[2]||(t[2]=o=>v.value=o)},null,512),[[c,v.value]])]),e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary",onClick:N},"Close"),t[20]||(t[20]=e("button",{type:"submit",class:"btn btn-primary"},"Save changes",-1))])],32)])])])])):M("",!0),g.value?(a(),n("div",re)):M("",!0),k.value?(a(),n("div",de,[e("div",ue,[e("div",ce,[e("div",me,[e("h5",pe,"Pay Bill - "+i(T.value),1),e("button",{type:"button",class:"close",onClick:S},[...t[21]||(t[21]=[e("span",null,"×",-1)])])]),e("div",ve,[e("form",{onSubmit:P(Z,["prevent"])},[e("fieldset",fe,[t[22]||(t[22]=e("legend",{class:"col-form-label pt-0"},"Payment Method",-1)),(a(!0),n(E,null,q($.value,(o,r)=>(a(),n("div",{key:r,class:"form-check form-check-inline"},[d(e("input",{class:"form-check-input",type:"radio",id:o.name,value:o.id,"onUpdate:modelValue":t[3]||(t[3]=U=>w.value=U)},null,8,be),[[L,w.value]]),e("label",{class:"form-check-label",for:o.name},i(o.name),9,he)]))),128))]),e("div",ye,[t[23]||(t[23]=e("label",{for:"reference_no"},"Reference Number",-1)),d(e("input",{type:"text",class:"form-control",id:"reference_no","onUpdate:modelValue":t[4]||(t[4]=o=>_.value=o),required:""},null,512),[[c,_.value]])]),e("div",ge,[t[24]||(t[24]=e("label",{for:"amount"},"Amount",-1)),d(e("input",{type:"number",class:"form-control",id:"amount","onUpdate:modelValue":t[5]||(t[5]=o=>x.value=o),required:""},null,512),[[c,x.value]])]),e("div",ke,[t[25]||(t[25]=e("label",{for:"remark"},"Remark (if any)",-1)),d(e("textarea",{class:"form-control",id:"remark","onUpdate:modelValue":t[6]||(t[6]=o=>C.value=o)},null,512),[[c,C.value]])]),e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary",onClick:S},"Close"),t[26]||(t[26]=e("button",{type:"submit",class:"btn btn-primary"},"Submit",-1))])],32)])])])])):M("",!0),k.value?(a(),n("div",_e)):M("",!0)]),_:1})],64))}};export{Me as default};
