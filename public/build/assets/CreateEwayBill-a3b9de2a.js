import{T as O,o as u,c,a,u as o,w as _,F as P,Z as F,b as e,d as p,t as r,f as U,n as E,x as G,e as R,h as d,k as v,Y as S,i as q,y as L,N as W}from"./app-08b61d9d.js";import{_ as A}from"./AuthenticatedLayout-e7b9904f.js";import{_ as K}from"./PrimaryButton-8ff02161.js";import{_ as m}from"./InputError-6872bf7a.js";import{S as b}from"./sweetalert2.esm.all-263d9c0b.js";import{_ as $}from"./_plugin-vue_export-helper-c27b6911.js";import"./FlashMessages-131ff3af.js";const z={class:"container-fluid p-4"},j={class:"card shadow-sm border-0 rounded-lg"},H={class:"card-body p-4"},J={class:"row"},Q={class:"col-md-4 border-right"},Y={class:"mb-3"},Z={class:"font-weight-bold d-flex align-items-center"},X={key:0,class:"ml-2 badge badge-warning",style:{"font-size":"10px"},title:"NIC portal allows max 16 chars. This will be automatically shortened."},ee={class:"mb-3"},te={class:"font-weight-bold"},se={class:"mb-3"},oe={class:"font-weight-bold"},le={class:"small text-muted"},ie={class:"mb-3"},ne={class:"font-weight-bold"},ae={class:"small d-flex align-items-center"},re={key:0,class:"ml-2 badge badge-danger",style:{"font-size":"10px"},title:"This GSTIN is invalid and will be treated as Unregistered Person (URP)"},de={class:"mb-3"},me={class:"font-weight-bold text-success"},ue={class:"mt-4"},ce={class:"text-muted mb-2"},pe={class:"table-responsive"},be={class:"table table-sm small"},ve={class:"text-truncate",style:{"max-width":"100px"}},fe={class:"col-md-8"},ge={class:"row"},ye={class:"col-md-6 mb-3"},we={class:"col-md-6 mb-3"},xe={class:"row"},he={class:"col-md-6 mb-3"},Te={class:"col-md-6 mb-3"},De={class:"row"},Se={class:"col-md-6 mb-3"},_e={class:"col-md-6 mb-3"},Ne={class:"row"},Ie={class:"col-md-6 mb-3"},Ve=["required"],ke={class:"col-md-6 mb-3"},Be={class:"row mt-4"},Pe={class:"col-md-6 mb-3"},Ue={class:"col-md-6 mb-3"},Ee={class:"mt-4 pt-3 border-top d-flex justify-content-between"},Me={key:0},Ce={key:1},Oe={__name:"CreateEwayBill",props:{invoice:Object,invoice_type:String},setup(n){var V,k;const f=n,s=O({invoice_id:f.invoice.id,supplyType:"O",subSupplyType:"1",subSupplyDesc:"",fromPincode:((V=f.invoice.company)==null?void 0:V.pin)||"",toPincode:((k=f.invoice.customer)==null?void 0:k.pin)||"",transMode:"1",transDistance:"",vehicleNo:f.invoice.vehicle_no||"",vehicleType:"R",transporterName:"",transporterId:"",transDocNo:"",transDocDate:"",transactionType:1,invoice_type:f.invoice_type}),M=()=>{if(s.transDistance>4e3){b.fire({icon:"warning",title:"Invalid Distance",text:"Distance cannot exceed 4000 KM for a single E-Way Bill."});return}b.fire({title:"Generating E-Way Bill...",text:"Please wait while we connect to the portal",allowOutsideClick:!1,didOpen:()=>{b.showLoading()}}),L.post(route("generate.eway.bill"),s.data()).then(i=>{b.close(),i.data.status===1&&b.fire({icon:"success",title:"Success!",text:i.data.message,confirmButtonText:"View List"}).then(()=>{W.get(route("invoice.list"))})}).catch(i=>{var y,w,x,h,T,D,l,B;b.close();const t=((w=(y=i.response)==null?void 0:y.data)==null?void 0:w.message)||"Something went wrong while generating the E-Way Bill",g=((D=(T=(h=(x=i.response)==null?void 0:x.data)==null?void 0:h.details)==null?void 0:T.error)==null?void 0:D.message)||"";b.fire({icon:"error",title:"Generation Failed",html:`<div>${t}</div>${g?`<div class="mt-2 small text-danger"><b>API Detail:</b> ${g}</div>`:""}`}),(B=(l=i.response)==null?void 0:l.data)!=null&&B.errors&&s.setErrors(i.response.data.errors)})},C=i=>i?new Date(i).toLocaleDateString("en-IN"):"",N=i=>i?i.trim().length===15:!1,I=i=>parseFloat(i||0).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2});return(i,t)=>(u(),c(P,null,[a(o(F),{title:"Generate E-Way Bill"}),a(A,null,{default:_(()=>{var g,y,w,x,h,T,D;return[e("div",z,[e("div",j,[t[39]||(t[39]=e("div",{class:"bg-purple-700 text-white py-2 px-3 rounded-t-lg position-relative"},[e("h4",{class:"text-sm mb-0 text-center uppercase font-weight-bold"},[e("i",{class:"fa fa-truck mr-2"}),p(" Generate E-Way Bill")])],-1)),e("div",H,[e("div",J,[e("div",Q,[t[18]||(t[18]=e("h5",{class:"text-secondary mb-4 border-bottom pb-2"},"Invoice Details",-1)),e("div",Y,[t[11]||(t[11]=e("label",{class:"text-muted small d-block mb-1"},"Invoice Number",-1)),e("div",Z,[p(r(n.invoice.invoice_number)+" ",1),n.invoice.invoice_number.length>16?(u(),c("span",X,[...t[10]||(t[10]=[e("i",{class:"fa fa-exclamation-triangle"},null,-1),p(" >16 Chars ",-1)])])):U("",!0)])]),e("div",ee,[t[12]||(t[12]=e("label",{class:"text-muted small d-block mb-1"},"Invoice Date",-1)),e("div",te,r(C(n.invoice.invoice_date)),1)]),e("div",se,[t[13]||(t[13]=e("label",{class:"text-muted small d-block mb-1"},"Seller",-1)),e("div",oe,r((g=n.invoice.company)==null?void 0:g.company_name),1),e("div",le,r((y=n.invoice.company)==null?void 0:y.gstin),1)]),e("div",ie,[t[15]||(t[15]=e("label",{class:"text-muted small d-block mb-1"},"Buyer",-1)),e("div",ne,r((w=n.invoice.customer)==null?void 0:w.company_name),1),e("div",ae,[e("span",{class:E(N((x=n.invoice.customer)==null?void 0:x.gstin)?"text-muted":"text-danger font-weight-bold")},r(((h=n.invoice.customer)==null?void 0:h.gstin)||"No GSTIN"),3),N((T=n.invoice.customer)==null?void 0:T.gstin)?U("",!0):(u(),c("span",re,[...t[14]||(t[14]=[e("i",{class:"fa fa-info-circle mr-1"},null,-1),p(" Treated as URP ",-1)])]))])]),e("div",de,[t[16]||(t[16]=e("label",{class:"text-muted small d-block mb-1"},"Total Amount",-1)),e("div",me,"â‚¹ "+r(I(n.invoice.subtotal_amount||n.invoice.total_ammount)),1)]),e("div",ue,[e("h6",ce,"Items ("+r((D=n.invoice.items)==null?void 0:D.length)+")",1),e("div",pe,[e("table",be,[t[17]||(t[17]=e("thead",null,[e("tr",null,[e("th",null,"Item"),e("th",null,"Qty"),e("th",null,"Amount")])],-1)),e("tbody",null,[(u(!0),c(P,null,G(n.invoice.items,l=>(u(),c("tr",{key:l.id},[e("td",ve,r(l.desc_product),1),e("td",null,r(l.quantity),1),e("td",null,r(I(l.subtotal_amount||l.rate*l.quantity)),1)]))),128))])])])])]),e("div",fe,[e("form",{onSubmit:R(M,["prevent"])},[t[38]||(t[38]=e("h5",{class:"text-secondary mb-4 border-bottom pb-2"},"Transport & Supply Details",-1)),e("div",ge,[e("div",ye,[t[19]||(t[19]=e("label",{class:"font-weight-bold"},"From Pincode (Seller)",-1)),d(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=l=>o(s).fromPincode=l),class:"form-control",placeholder:"6-digit Pincode",maxlength:"6",required:""},null,512),[[v,o(s).fromPincode]]),a(m,{message:o(s).errors.fromPincode},null,8,["message"])]),e("div",we,[t[20]||(t[20]=e("label",{class:"font-weight-bold"},"To Pincode (Buyer)",-1)),d(e("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=l=>o(s).toPincode=l),class:"form-control",placeholder:"6-digit Pincode",maxlength:"6",required:""},null,512),[[v,o(s).toPincode]]),a(m,{message:o(s).errors.toPincode},null,8,["message"])])]),e("div",xe,[e("div",he,[t[22]||(t[22]=e("label",{class:"font-weight-bold"},"Supply Type",-1)),d(e("select",{"onUpdate:modelValue":t[2]||(t[2]=l=>o(s).supplyType=l),class:"form-control"},[...t[21]||(t[21]=[e("option",{value:"O"},"Outward",-1),e("option",{value:"I"},"Inward",-1)])],512),[[S,o(s).supplyType]]),a(m,{message:o(s).errors.supplyType},null,8,["message"])]),e("div",Te,[t[24]||(t[24]=e("label",{class:"font-weight-bold"},"Sub Supply Type",-1)),d(e("select",{"onUpdate:modelValue":t[3]||(t[3]=l=>o(s).subSupplyType=l),class:"form-control"},[...t[23]||(t[23]=[e("option",{value:"1"},"Supply",-1),e("option",{value:"2"},"Import",-1),e("option",{value:"3"},"Export",-1),e("option",{value:"4"},"Job Work",-1),e("option",{value:"5"},"For Own Use",-1),e("option",{value:"6"},"SKD/CKD",-1),e("option",{value:"7"},"Recipient Not Known",-1),e("option",{value:"8"},"Exhibition or Fairs",-1),e("option",{value:"9"},"Line Sales",-1),e("option",{value:"10"},"Others",-1)])],512),[[S,o(s).subSupplyType]]),a(m,{message:o(s).errors.subSupplyType},null,8,["message"])])]),e("div",De,[e("div",Se,[t[26]||(t[26]=e("label",{class:"font-weight-bold"},"Transport Mode",-1)),d(e("select",{"onUpdate:modelValue":t[4]||(t[4]=l=>o(s).transMode=l),class:"form-control"},[...t[25]||(t[25]=[e("option",{value:"1"},"Road",-1),e("option",{value:"2"},"Rail",-1),e("option",{value:"3"},"Air",-1),e("option",{value:"4"},"Ship",-1)])],512),[[S,o(s).transMode]]),a(m,{message:o(s).errors.transMode},null,8,["message"])]),e("div",_e,[t[27]||(t[27]=e("label",{class:"font-weight-bold"},"Distance (approx. KM)",-1)),d(e("input",{type:"number","onUpdate:modelValue":t[5]||(t[5]=l=>o(s).transDistance=l),class:"form-control",placeholder:"Distance in Km",required:""},null,512),[[v,o(s).transDistance]]),a(m,{message:o(s).errors.transDistance},null,8,["message"])])]),e("div",Ne,[e("div",Ie,[t[28]||(t[28]=e("label",{class:"font-weight-bold"},"Vehicle Number",-1)),d(e("input",{type:"text","onUpdate:modelValue":t[6]||(t[6]=l=>o(s).vehicleNo=l),class:"form-control",placeholder:"e.g. MH01AB1234",required:o(s).transMode=="1"},null,8,Ve),[[v,o(s).vehicleNo]]),t[29]||(t[29]=e("small",{class:"text-muted"},"Mandatory for Road transport",-1)),a(m,{message:o(s).errors.vehicleNo},null,8,["message"])]),e("div",ke,[t[31]||(t[31]=e("label",{class:"font-weight-bold"},"Vehicle Type",-1)),d(e("select",{"onUpdate:modelValue":t[7]||(t[7]=l=>o(s).vehicleType=l),class:"form-control"},[...t[30]||(t[30]=[e("option",{value:"R"},"Regular",-1),e("option",{value:"O"},"Over Dimensional Cargo",-1)])],512),[[S,o(s).vehicleType]]),a(m,{message:o(s).errors.vehicleType},null,8,["message"])])]),e("div",Be,[t[34]||(t[34]=e("div",{class:"col-12"},[e("h6",{class:"text-muted mb-3 border-bottom pb-1"},"Optional Transporter Info")],-1)),e("div",Pe,[t[32]||(t[32]=e("label",null,"Transporter Name",-1)),d(e("input",{type:"text","onUpdate:modelValue":t[8]||(t[8]=l=>o(s).transporterName=l),class:"form-control"},null,512),[[v,o(s).transporterName]])]),e("div",Ue,[t[33]||(t[33]=e("label",null,"Transporter ID",-1)),d(e("input",{type:"text","onUpdate:modelValue":t[9]||(t[9]=l=>o(s).transporterId=l),class:"form-control"},null,512),[[v,o(s).transporterId]])])]),e("div",Ee,[a(o(q),{href:i.route("invoice.list"),class:"btn btn-outline-secondary"},{default:_(()=>[...t[35]||(t[35]=[e("i",{class:"fa fa-arrow-left"},null,-1),p(" Back to List ",-1)])]),_:1},8,["href"]),a(K,{class:E({"opacity-25":o(s).processing}),disabled:o(s).processing},{default:_(()=>[o(s).processing?(u(),c("span",Me,[...t[36]||(t[36]=[e("i",{class:"fa fa-spinner fa-spin mr-1"},null,-1),p(" Generating...",-1)])])):(u(),c("span",Ce,[...t[37]||(t[37]=[e("i",{class:"fa fa-paper-plane mr-1"},null,-1),p(" Generate E-Way Bill",-1)])]))]),_:1},8,["class","disabled"])])],32)])])])])])]}),_:1})],64))}},Ke=$(Oe,[["__scopeId","data-v-2b563e54"]]);export{Ke as default};
