import{T as $,p as s,o as n,c as i,a as d,u as _,w as h,F as E,Z as j,b as e,x as q,t as a,n as R,i as B,d as r,e as P,h as c,k as f,f as V,y as z,A as T}from"./app-dc8aafa4.js";import{_ as L}from"./AuthenticatedLayout-67f71654.js";/* empty css                                              */import{S as v}from"./sweetalert2.all-419194cf.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./FlashMessages-07e1c4c4.js";const G=e("div",{class:"inline-flex w-full mb-4 overflow-hidden bg-white rounded-lg shadow-md"},[e("div",{class:"flex items-center justify-center w-12 bg-pink-800"},[e("svg",{class:"w-6 h-6 text-white fill-current",viewBox:"0 0 40 40",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M20 3.33331C10.8 3.33331 3.33337 10.8 3.33337 20C3.33337 29.2 10.8 36.6666 20 36.6666C29.2 36.6666 36.6667 29.2 36.6667 20C36.6667 10.8 29.2 3.33331 20 3.33331ZM21.6667 28.3333H18.3334V25H21.6667V28.3333ZM21.6667 21.6666H18.3334V11.6666H21.6667V21.6666Z"})])]),e("div",{class:"px-4 py-2 -mx-3"},[e("div",{class:"mx-3"},[e("span",{class:"font-semibold text-blue-500"},"Invoice List")])])],-1),W={class:"bg-white rounded-lg shadow"},J={class:"rounded-lg table-responsive"},Q={class:"table",style:{"min-height":"200px"}},X=e("thead",{class:"table-dark"},[e("tr",null,[e("th",{class:"col-1"},"Sr.no."),e("th",{class:"col-1"},"Invoice Number"),e("th",{class:"col-1"},"Invoice Date"),e("th",{class:"col-1"},"Total Amount"),e("th",{class:"col-1"},"Paid Amount"),e("th",{class:"col-2"},"Payment Status"),e("th",{class:"col-1"},"Vehicle No"),e("th",{class:"col-1"},"No. Packets"),e("th",{class:"col-1"},"Customer"),e("th",{class:"col-1"},"Company"),e("th",{class:"col-1"},"Action")])],-1),Y={class:"dropdown"},ee=e("span",{class:"p-2",style:{"font-size":"15px",cursor:"pointer"},"data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa fa-ellipsis-v"})],-1),te={class:"dropdown-menu"},oe=e("i",{class:"fa-solid fa-pen-to-square",style:{color:"blueviolet"}},null,-1),le=e("i",{class:"fa fa-print","aria-hidden":"true",style:{color:"rgb(241, 12, 12)"}},null,-1),se=e("i",{class:"fa fa-envelope-square","aria-hidden":"true",style:{color:"rgb(245, 180, 0)"}},null,-1),ae=e("i",{class:"fa fa-envelope-square","aria-hidden":"true",style:{color:"rgb(245, 180, 0)"}},null,-1),ne=["onClick"],ie=e("i",{class:"fa fa-car","aria-hidden":"true",style:{color:"rgb(245, 180, 0)"}},null,-1),de=["onClick"],re=e("i",{class:"fa fa-inr","aria-hidden":"true",style:{color:"rgb(245, 180, 0)"}},null,-1),ce=e("div",{class:"flex flex-col items-center px-1 py-1 bg-white border-t xs:flex-row xs:justify-between"},null,-1),ue={key:0,class:"modal fade show",style:{display:"block"},"aria-modal":"true",role:"dialog"},me={class:"modal-dialog",role:"document"},pe={class:"modal-content"},_e=e("h5",{class:"modal-title"},"Update Package",-1),he=e("span",null,"×",-1),fe=[he],ve={class:"modal-body"},be={class:"form-group mb-3"},ye=e("label",{for:"no_packets"},"No. of Package",-1),ge={class:"form-group mb-3"},ke=e("label",{for:"vehicle_no"},"Vehicle Number",-1),xe=e("button",{type:"submit",class:"btn btn-primary"},"Save changes",-1),we={key:1,class:"modal-backdrop fade show"},Ce={key:2,class:"modal fade show",style:{display:"block"},"aria-modal":"true",role:"dialog"},Be={class:"modal-dialog",role:"document"},Pe={class:"modal-content"},Ve=e("h5",{class:"modal-title"},"Pay Bill",-1),Te=e("span",null,"×",-1),Me=[Te],Ne={class:"modal-body"},Se={class:"mb-3"},Ee=e("legend",{class:"col-form-label pt-0"},"Payment Method",-1),Ue=["id","value"],qe=["for"],Oe={class:"form-group mb-3"},Ae=e("label",{for:"reference_no"},"Reference Number",-1),Ke={class:"form-group mb-3"},Ie=e("label",{for:"reference_no"},"Amount",-1),De={class:"form-group mb-3"},Fe=e("label",{for:"remark"},"Remark (if any)",-1),He=e("button",{type:"submit",class:"btn btn-primary"},"Submit",-1),Ze={key:3,class:"modal-backdrop fade show"},We={__name:"invoice_list",props:{invoices:Object},setup(O){const A=O;$({});const b=s(!1),u=s(""),m=s(""),p=s(null),K=s(A.invoices),I=o=>{b.value=!0,p.value=o,T.get(`/api/fetch-invoice/${o}`).then(l=>{const t=l.data;u.value=t.no_packets||"",m.value=t.vehicle_no||"",p.value=t.id||""}).catch(l=>{console.error("Error fetching invoice:",l)})},M=()=>{b.value=!1,u.value="",m.value=""},D=()=>{T.post("/api/update-invoice-package",{no_packets:u.value,vehicle_no:m.value,invoice_id:p.value}).then(o=>{console.log("Package updated successfully:",o.data),v.fire({title:"Success!",text:"Package updated successfully.",icon:"success",confirmButtonText:"OK"}).then(()=>{setTimeout(()=>{location.reload()},1e4)}),M(),location.reload()}).catch(o=>{console.error("Error updating package:",o),v.fire({title:"Error!",text:"There was an error updating the package.",icon:"error",confirmButtonText:"OK"})})},y=s(!1),g=s(""),k=s(""),x=s(""),w=s(""),U=s([]),N=()=>{y.value=!1,k.value="",g.value="",x.value="",w.value=""},F=o=>{y.value=!0,p.value=o,T.get("/api/fetch-payment-types").then(l=>{U.value=l.data}).catch(l=>{console.error("Error fetching types:",l)})},H=()=>{T.post("/api/pay-bill",{payment_method_id:k.value,reference_no:g.value,amount:x.value,remark:w.value,invoice_id:p.value}).then(o=>{console.log("Bill paid successfully:",o),o.data.status==1?v.fire({title:"Success!",text:o.data.message,icon:"success",confirmButtonText:"OK"}).then(()=>{setTimeout(()=>{location.reload()},5e3)}):v.fire({title:"Info!",text:o.data.message,icon:"warning",confirmButtonText:"OK"}).then(()=>{setTimeout(()=>{location.reload()},5e3)}),N()}).catch(o=>{console.error("Error paying bill:",o),v.fire({title:"Error!",text:"There was an error paying the bill.",icon:"error",confirmButtonText:"OK"})})};return(o,l)=>(n(),i(E,null,[d(_(j),{title:"Customer view"}),d(L,null,{default:h(()=>[G,e("div",W,[e("div",J,[e("table",Q,[X,e("tbody",null,[(n(!0),i(E,null,q(K.value,(t,S)=>{var C;return n(),i("tr",{key:t.id},[e("td",null,a(S+1),1),e("td",null,a(t.invoice_number??""),1),e("td",null,a(t.invoice_date??""),1),e("td",null,a(t.total_ammount??""),1),e("td",null,a(((C=t.payment)==null?void 0:C.paid_amount)??""),1),e("td",null,[e("span",{class:R(["px-3 py-1 mr-2 text-xs font-medium rounded-full",{"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300":t.payment.status==="due","bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300":t.payment.status==="partial-paid","bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":t.payment.status==="paid"}])},a(t.payment.status),3)]),e("td",null,a(t.vehicle_no??""),1),e("td",null,a(t.no_packets??"NO PACK"),1),e("td",null,a(t.customer.company_name??""),1),e("td",null,a(t.company.company_name??""),1),e("td",null,[e("div",Y,[ee,e("ul",te,[e("li",null,[d(_(B),{class:"dropdown-item",href:o.route("customer.bill.edit"),method:"get",data:{invoice_id:t.id}},{default:h(()=>[oe,r(" Edit")]),_:2},1032,["href","data"])]),e("li",null,[d(_(B),{href:o.route("view.invoice"),method:"get",data:{invoice_id:t.id},class:"dropdown-item"},{default:h(()=>[le,r(" Print")]),_:2},1032,["href","data"])]),e("li",null,[d(_(B),{class:"dropdown-item",href:o.route("bill.sendmail"),method:"post",data:{invoice_id:t.id}},{default:h(()=>[se,r(" Mail")]),_:2},1032,["href","data"])]),e("li",null,[d(_(B),{class:"dropdown-item",href:o.route("create.eway.bill"),method:"get",data:{invoice_id:t.id}},{default:h(()=>[ae,r(" Generate E-Way Bill")]),_:2},1032,["href","data"])]),e("li",null,[e("a",{onClick:P(Z=>I(t.id),["prevent"]),class:"dropdown-item",href:"#"},[ie,r(" Package Update ")],8,ne)]),e("li",null,[e("a",{onClick:P(Z=>F(t.id),["prevent"]),class:"dropdown-item",href:"#"},[re,r(" Pay Bill ")],8,de)])])])])])}),128))])])]),ce]),b.value?(n(),i("div",ue,[e("div",me,[e("div",pe,[e("div",{class:"modal-header"},[_e,e("button",{type:"button",class:"close",onClick:M},fe)]),e("div",ve,[e("form",{onSubmit:P(D,["prevent"])},[e("div",be,[ye,c(e("input",{type:"number",class:"form-control",id:"no_packets","onUpdate:modelValue":l[0]||(l[0]=t=>u.value=t),required:""},null,512),[[f,u.value]])]),e("div",ge,[ke,c(e("input",{type:"text",class:"form-control",id:"vehicle_no","onUpdate:modelValue":l[1]||(l[1]=t=>m.value=t),required:""},null,512),[[f,m.value]])]),e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary",onClick:M},"Close"),xe])],32)])])])])):V("",!0),b.value?(n(),i("div",we)):V("",!0),y.value?(n(),i("div",Ce,[e("div",Be,[e("div",Pe,[e("div",{class:"modal-header"},[Ve,e("button",{type:"button",class:"close",onClick:N},Me)]),e("div",Ne,[e("form",{onSubmit:P(H,["prevent"])},[e("fieldset",Se,[Ee,(n(!0),i(E,null,q(U.value,(t,S)=>(n(),i("div",{key:S,class:"form-check form-check-inline"},[c(e("input",{class:"form-check-input",type:"radio",id:t.name,value:t.id,"onUpdate:modelValue":l[2]||(l[2]=C=>k.value=C)},null,8,Ue),[[z,k.value]]),e("label",{class:"form-check-label",for:t.name},a(t.name),9,qe)]))),128))]),e("div",Oe,[Ae,c(e("input",{type:"text",class:"form-control",id:"reference_no","onUpdate:modelValue":l[3]||(l[3]=t=>g.value=t),required:""},null,512),[[f,g.value]])]),e("div",Ke,[Ie,c(e("input",{type:"number",class:"form-control",id:"reference_no","onUpdate:modelValue":l[4]||(l[4]=t=>x.value=t),required:""},null,512),[[f,x.value]])]),e("div",De,[Fe,c(e("textarea",{class:"form-control",id:"remark","onUpdate:modelValue":l[5]||(l[5]=t=>w.value=t)},null,512),[[f,w.value]])]),e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary",onClick:N},"Close"),He])],32)])])])])):V("",!0),y.value?(n(),i("div",Ze)):V("",!0)]),_:1})],64))}};export{We as default};
