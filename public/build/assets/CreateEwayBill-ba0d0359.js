import{T as k,o as y,c as f,a as r,u as o,w as _,F as S,Z as B,b as t,d as g,t as a,x as V,e as E,h as d,X as w,k as x,i as M,n as O,y as U,N as C}from"./app-5b33cb9d.js";import{_ as F}from"./AuthenticatedLayout-ae0074d3.js";import{_ as L}from"./PrimaryButton-f8b14db4.js";import{_ as m}from"./InputError-44202dc9.js";import{S as u}from"./sweetalert2.esm.all-263d9c0b.js";import{_ as R}from"./_plugin-vue_export-helper-c27b6911.js";import"./FlashMessages-e07e93db.js";const G={class:"container-fluid p-4"},W={class:"card shadow-sm border-0 rounded-lg"},q={class:"card-body p-4"},A={class:"row"},K={class:"col-md-4 border-right"},$={class:"mb-3"},j={class:"font-weight-bold"},z={class:"mb-3"},H={class:"font-weight-bold"},J={class:"mb-3"},P={class:"font-weight-bold"},Q={class:"small text-muted"},X={class:"mb-3"},Z={class:"font-weight-bold"},Y={class:"small text-muted"},tt={class:"mb-3"},et={class:"font-weight-bold text-success"},st={class:"mt-4"},ot={class:"text-muted mb-2"},lt={class:"table-responsive"},nt={class:"table table-sm small"},it={class:"text-truncate",style:{"max-width":"100px"}},at={class:"col-md-8"},rt={class:"row"},dt={class:"col-md-6 mb-3"},mt={class:"col-md-6 mb-3"},ut={class:"row"},pt={class:"col-md-6 mb-3"},ct={class:"col-md-6 mb-3"},bt={class:"row"},vt={class:"col-md-6 mb-3"},yt=["required"],ft={class:"col-md-6 mb-3"},gt={class:"row mt-4"},wt={class:"col-md-6 mb-3"},xt={class:"col-md-6 mb-3"},_t={class:"mt-4 pt-3 border-top d-flex justify-content-between"},ht={key:0},Tt={key:1},Dt={__name:"CreateEwayBill",props:{invoice:Object,invoice_type:String},setup(i){const h=i,s=k({invoice_id:h.invoice.id,supplyType:"O",subSupplyType:"1",subSupplyDesc:"",transMode:"1",transDistance:"",vehicleNo:h.invoice.vehicle_no||"",vehicleType:"R",transporterName:"",transporterId:"",transDocNo:"",transDocDate:"",transactionType:1}),N=()=>{u.fire({title:"Generating E-Way Bill...",text:"Please wait while we connect to the portal",allowOutsideClick:!1,didOpen:()=>{u.showLoading()}}),U.post(route("generate.eway.bill"),s.data()).then(n=>{u.close(),n.data.status===1&&u.fire({icon:"success",title:"Success!",text:n.data.message,confirmButtonText:"View List"}).then(()=>{C.get(route("invoice.list"))})}).catch(n=>{var p,c,b,v;u.close();const e=((c=(p=n.response)==null?void 0:p.data)==null?void 0:c.message)||"Something went wrong while generating the E-Way Bill";u.fire({icon:"error",title:"Generation Failed",text:e}),(v=(b=n.response)==null?void 0:b.data)!=null&&v.errors&&s.setErrors(n.response.data.errors)})},I=n=>n?new Date(n).toLocaleDateString("en-IN"):"",T=n=>parseFloat(n||0).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2});return(n,e)=>(y(),f(S,null,[r(o(B),{title:"Generate E-Way Bill"}),r(F,null,{default:_(()=>{var p,c,b,v,D;return[t("div",G,[t("div",W,[e[33]||(e[33]=t("div",{class:"bg-purple-700 text-white py-2 px-3 rounded-t-lg position-relative"},[t("h4",{class:"text-sm mb-0 text-center uppercase font-weight-bold"},[t("i",{class:"fa fa-truck mr-2"}),g(" Generate E-Way Bill")])],-1)),t("div",q,[t("div",A,[t("div",K,[e[14]||(e[14]=t("h5",{class:"text-secondary mb-4 border-bottom pb-2"},"Invoice Details",-1)),t("div",$,[e[8]||(e[8]=t("label",{class:"text-muted small d-block mb-1"},"Invoice Number",-1)),t("div",j,a(i.invoice.invoice_number),1)]),t("div",z,[e[9]||(e[9]=t("label",{class:"text-muted small d-block mb-1"},"Invoice Date",-1)),t("div",H,a(I(i.invoice.invoice_date)),1)]),t("div",J,[e[10]||(e[10]=t("label",{class:"text-muted small d-block mb-1"},"Seller",-1)),t("div",P,a((p=i.invoice.company)==null?void 0:p.company_name),1),t("div",Q,a((c=i.invoice.company)==null?void 0:c.gstin),1)]),t("div",X,[e[11]||(e[11]=t("label",{class:"text-muted small d-block mb-1"},"Buyer",-1)),t("div",Z,a((b=i.invoice.customer)==null?void 0:b.company_name),1),t("div",Y,a((v=i.invoice.customer)==null?void 0:v.gstin),1)]),t("div",tt,[e[12]||(e[12]=t("label",{class:"text-muted small d-block mb-1"},"Total Amount",-1)),t("div",et,"â‚¹ "+a(T(i.invoice.subtotal_amount||i.invoice.total_ammount)),1)]),t("div",st,[t("h6",ot,"Items ("+a((D=i.invoice.items)==null?void 0:D.length)+")",1),t("div",lt,[t("table",nt,[e[13]||(e[13]=t("thead",null,[t("tr",null,[t("th",null,"Item"),t("th",null,"Qty"),t("th",null,"Amount")])],-1)),t("tbody",null,[(y(!0),f(S,null,V(i.invoice.items,l=>(y(),f("tr",{key:l.id},[t("td",it,a(l.desc_product),1),t("td",null,a(l.quantity),1),t("td",null,a(T(l.subtotal_amount||l.rate*l.quantity)),1)]))),128))])])])])]),t("div",at,[t("form",{onSubmit:E(N,["prevent"])},[e[32]||(e[32]=t("h5",{class:"text-secondary mb-4 border-bottom pb-2"},"Transport & Supply Details",-1)),t("div",rt,[t("div",dt,[e[16]||(e[16]=t("label",{class:"font-weight-bold"},"Supply Type",-1)),d(t("select",{"onUpdate:modelValue":e[0]||(e[0]=l=>o(s).supplyType=l),class:"form-control"},[...e[15]||(e[15]=[t("option",{value:"O"},"Outward",-1),t("option",{value:"I"},"Inward",-1)])],512),[[w,o(s).supplyType]]),r(m,{message:o(s).errors.supplyType},null,8,["message"])]),t("div",mt,[e[18]||(e[18]=t("label",{class:"font-weight-bold"},"Sub Supply Type",-1)),d(t("select",{"onUpdate:modelValue":e[1]||(e[1]=l=>o(s).subSupplyType=l),class:"form-control"},[...e[17]||(e[17]=[t("option",{value:"1"},"Supply",-1),t("option",{value:"2"},"Import",-1),t("option",{value:"3"},"Export",-1),t("option",{value:"4"},"Job Work",-1),t("option",{value:"5"},"For Own Use",-1),t("option",{value:"6"},"SKD/CKD",-1),t("option",{value:"7"},"Recipient Not Known",-1),t("option",{value:"8"},"Exhibition or Fairs",-1),t("option",{value:"9"},"Line Sales",-1),t("option",{value:"10"},"Others",-1)])],512),[[w,o(s).subSupplyType]]),r(m,{message:o(s).errors.subSupplyType},null,8,["message"])])]),t("div",ut,[t("div",pt,[e[20]||(e[20]=t("label",{class:"font-weight-bold"},"Transport Mode",-1)),d(t("select",{"onUpdate:modelValue":e[2]||(e[2]=l=>o(s).transMode=l),class:"form-control"},[...e[19]||(e[19]=[t("option",{value:"1"},"Road",-1),t("option",{value:"2"},"Rail",-1),t("option",{value:"3"},"Air",-1),t("option",{value:"4"},"Ship",-1)])],512),[[w,o(s).transMode]]),r(m,{message:o(s).errors.transMode},null,8,["message"])]),t("div",ct,[e[21]||(e[21]=t("label",{class:"font-weight-bold"},"Distance (approx. KM)",-1)),d(t("input",{type:"number","onUpdate:modelValue":e[3]||(e[3]=l=>o(s).transDistance=l),class:"form-control",placeholder:"Distance in Km",required:""},null,512),[[x,o(s).transDistance]]),r(m,{message:o(s).errors.transDistance},null,8,["message"])])]),t("div",bt,[t("div",vt,[e[22]||(e[22]=t("label",{class:"font-weight-bold"},"Vehicle Number",-1)),d(t("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=l=>o(s).vehicleNo=l),class:"form-control",placeholder:"e.g. MH01AB1234",required:o(s).transMode=="1"},null,8,yt),[[x,o(s).vehicleNo]]),e[23]||(e[23]=t("small",{class:"text-muted"},"Mandatory for Road transport",-1)),r(m,{message:o(s).errors.vehicleNo},null,8,["message"])]),t("div",ft,[e[25]||(e[25]=t("label",{class:"font-weight-bold"},"Vehicle Type",-1)),d(t("select",{"onUpdate:modelValue":e[5]||(e[5]=l=>o(s).vehicleType=l),class:"form-control"},[...e[24]||(e[24]=[t("option",{value:"R"},"Regular",-1),t("option",{value:"O"},"Over Dimensional Cargo",-1)])],512),[[w,o(s).vehicleType]]),r(m,{message:o(s).errors.vehicleType},null,8,["message"])])]),t("div",gt,[e[28]||(e[28]=t("div",{class:"col-12"},[t("h6",{class:"text-muted mb-3 border-bottom pb-1"},"Optional Transporter Info")],-1)),t("div",wt,[e[26]||(e[26]=t("label",null,"Transporter Name",-1)),d(t("input",{type:"text","onUpdate:modelValue":e[6]||(e[6]=l=>o(s).transporterName=l),class:"form-control"},null,512),[[x,o(s).transporterName]])]),t("div",xt,[e[27]||(e[27]=t("label",null,"Transporter ID",-1)),d(t("input",{type:"text","onUpdate:modelValue":e[7]||(e[7]=l=>o(s).transporterId=l),class:"form-control"},null,512),[[x,o(s).transporterId]])])]),t("div",_t,[r(o(M),{href:n.route("invoice.list"),class:"btn btn-outline-secondary"},{default:_(()=>[...e[29]||(e[29]=[t("i",{class:"fa fa-arrow-left"},null,-1),g(" Back to List ",-1)])]),_:1},8,["href"]),r(L,{class:O({"opacity-25":o(s).processing}),disabled:o(s).processing},{default:_(()=>[o(s).processing?(y(),f("span",ht,[...e[30]||(e[30]=[t("i",{class:"fa fa-spinner fa-spin mr-1"},null,-1),g(" Generating...",-1)])])):(y(),f("span",Tt,[...e[31]||(e[31]=[t("i",{class:"fa fa-paper-plane mr-1"},null,-1),g(" Generate E-Way Bill",-1)])]))]),_:1},8,["class","disabled"])])],32)])])])])])]}),_:1})],64))}},Mt=R(Dt,[["__scopeId","data-v-ca4c4dce"]]);export{Mt as default};
