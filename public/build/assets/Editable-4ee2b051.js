import{T as U,p as c,o as r,c as d,b as l,a as j,w as G,q as J,F as f,x as D,t as v,d as X,f as K,y as Y}from"./app-6a1d3a1e.js";import{_ as Z}from"./_plugin-vue_export-helper-c27b6911.js";const I={key:0},x={class:"rounded-lg shadow table-responsive"},tt={class:"table table-bordered"},et=["onInput"],lt={class:"position-relative"},ot=["value","onInput","onFocus","onBlur"],nt={key:0,class:"dropdown-menu show position-absolute w-100",style:{top:"100%","z-index":"1000","max-height":"200px","overflow-y":"auto"}},st=["onMousedown"],at=["onInput"],ut=["onInput"],it=["onInput"],rt=["onInput"],dt=["onClick"],ct=["onClick"],vt={class:"font-bold"},pt={class:"font-bold"},mt={__name:"Editable",setup(bt){const $=U({}),a=c([["","","","","",""]]),y=c([]),b=c(!0),u=c({}),i=c({}),g=c(null),q=()=>{b.value=!b.value},p=(o,t,s)=>{let n=s.target.innerText;[2,4,5].includes(t)&&(n=parseFloat(n),isNaN(n)&&(n=0)),a.value[o][t]=n},W=async(o,t)=>{const s=t.target.value;if(a.value[o][1]=s,g.value&&clearTimeout(g.value),!s.trim()){i.value[o]=!1,u.value[o]=[];return}g.value=setTimeout(async()=>{try{const n=await Y.get("/hsn/search",{params:{q:s}});u.value[o]=n.data,i.value[o]=!0}catch(n){console.error("Error searching HSN codes:",n),u.value[o]=[]}},300)},O=(o,t)=>{a.value[o][1]=t.code,i.value[o]=!1,u.value[o]=[]},w=o=>{setTimeout(()=>{i.value[o]=!1},150)},m=o=>{const t=window.getSelection();if(!t.rangeCount)return;const s=t.getRangeAt(0);o.target.dataset.cursorStart=s.startOffset},z=o=>{const t=["","","","","",""];a.value.splice(o+1,0,t)},A=o=>{if(a.value.length>1){a.value.splice(o,1),delete u.value[o],delete i.value[o];const t={},s={};a.value.forEach((n,e)=>{u.value[e+(e>=o?1:0)]&&(t[e]=u.value[e+(e>=o?1:0)]),i.value[e+(e>=o?1:0)]&&(s[e]=i.value[e+(e>=o?1:0)])}),u.value=t,i.value=s}},h=o=>{const t=parseFloat(a.value[o][2])||0,s=parseFloat(a.value[o][5])||0;return(t*s).toFixed(2)},_=()=>a.value.reduce((o,t,s)=>o+parseFloat(h(s)),0).toFixed(2),C=()=>a.value.reduce((o,t)=>o+(parseFloat(t[4])||0),0).toFixed(2),M=()=>{var T,k,B,F,N,S,V,R,H;const o=((T=document.getElementById("invoice_no"))==null?void 0:T.value)||"",t=((k=document.getElementById("customer"))==null?void 0:k.value)||"",s=((B=document.getElementById("company"))==null?void 0:B.value)||"",n=((F=document.getElementById("vehical_no"))==null?void 0:F.value)||"",e=((N=document.getElementById("customer_name"))==null?void 0:N.value)||"",E=((S=document.getElementById("mobile"))==null?void 0:S.value)||"",L=((V=document.getElementById("address"))==null?void 0:V.value)||"",P=((R=document.getElementById("email"))==null?void 0:R.value)||"",Q=((H=document.getElementById("gst"))==null?void 0:H.value)||"";y.value[0]={invoice:o,customer:t,company:s,vehical_no:n,totalWeight:C(),totalTaxableValue:_(),name:e,mobile:E,address:L,email:P,gst:Q},$.post(route("customer.store.bill",{invoicedata:a.value,invoicedetails:y.value}),{preserveScroll:!0})};return(o,t)=>(r(),d(f,null,[l("div",{class:"mt-5 bg-purple-700 rounded-md position-relative py-2 px-3"},[t[6]||(t[6]=l("h2",{class:"text-sm font-medium text-center text-white font-weight-bolder mb-0"}," INVOICE ",-1)),l("span",{class:"text-white cursor-pointer top-2 right-3 position-absolute",onClick:q},[...t[5]||(t[5]=[l("i",{class:"fa-solid fa-bullseye fa-lg"},null,-1)])])]),j(J,{name:"slide-fade"},{default:G(()=>[b.value?(r(),d("div",I,[l("div",x,[l("table",tt,[t[13]||(t[13]=l("thead",{class:"table-dark"},[l("tr",null,[l("th",null,"S.NO."),l("th",null,"Description of Product"),l("th",null,"HSN Code"),l("th",null,"Quantity"),l("th",null,"Unit"),l("th",null,"Weight"),l("th",null,"Rate"),l("th",null,"Taxable Value"),l("th",null,"Action")])],-1)),l("tbody",null,[(r(!0),d(f,null,D(a.value,(s,n)=>(r(),d("tr",{key:n},[l("td",null,v(n+1),1),l("td",{contenteditable:"",onInput:e=>p(n,0,e),onKeydown:t[0]||(t[0]=e=>m(e))},null,40,et),l("td",lt,[l("input",{type:"text",value:s[1],onInput:e=>W(n,e),onFocus:e=>i.value[n]=!0,onBlur:e=>w(n),class:"form-control border-0 p-1",placeholder:"Enter HSN Code",autocomplete:"off"},null,40,ot),i.value[n]&&u.value[n]&&u.value[n].length>0?(r(),d("div",nt,[(r(!0),d(f,null,D(u.value[n],e=>(r(),d("div",{key:e.code,onMousedown:E=>O(n,e),class:"dropdown-item cursor-pointer hover-item",style:{"font-size":"12px",padding:"8px 12px"}},[l("strong",null,v(e.code),1),X(" - "+v(e.description),1)],40,st))),128))])):K("",!0)]),l("td",{contenteditable:"",onInput:e=>p(n,2,e),onKeydown:t[1]||(t[1]=e=>m(e))},null,40,at),l("td",{contenteditable:"",onInput:e=>p(n,3,e),onKeydown:t[2]||(t[2]=e=>m(e))},null,40,ut),l("td",{contenteditable:"",onInput:e=>p(n,4,e),onKeydown:t[3]||(t[3]=e=>m(e))},null,40,it),l("td",{contenteditable:"",onInput:e=>p(n,5,e),onKeydown:t[4]||(t[4]=e=>m(e))},null,40,rt),l("td",null,v(h(n)),1),l("td",null,[n===a.value.length-1?(r(),d("span",{key:0,class:"cursor-pointer badge rounded-pill text-bg-primary",onClick:e=>z(n)},[...t[7]||(t[7]=[l("i",{class:"fa fa-plus","aria-hidden":"true"},null,-1)])],8,dt)):(r(),d("span",{key:1,class:"cursor-pointer badge rounded-pill text-bg-danger",onClick:e=>A(n)},[...t[8]||(t[8]=[l("i",{class:"fa fa-minus","aria-hidden":"true"},null,-1)])],8,ct))])]))),128)),l("tr",null,[t[9]||(t[9]=l("td",{colspan:"4"},null,-1)),t[10]||(t[10]=l("td",{class:"font-bold"},"Total Weight:",-1)),l("td",vt,v(C()),1),t[11]||(t[11]=l("td",{class:"font-bold"},"Total:",-1)),l("td",pt,v(_()),1),t[12]||(t[12]=l("td",null,null,-1))])])])]),l("button",{class:"text-white btn btn-info text-bold mt-3",onClick:M}," Submit ")])):K("",!0)]),_:1})],64))}},yt=Z(mt,[["__scopeId","data-v-e387b781"]]);export{yt as default};
