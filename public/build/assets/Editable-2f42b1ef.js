import{T as G,p as c,o as r,c as d,b as l,a as J,w as X,q as Y,F as y,x as K,t as v,d as Z,f as $,y as I}from"./app-08b61d9d.js";import{_ as x}from"./_plugin-vue_export-helper-c27b6911.js";const tt={key:0},et={class:"rounded-lg shadow table-responsive"},lt={class:"table table-bordered"},ot=["onInput"],nt={class:"position-relative"},st=["value","onInput","onFocus","onBlur"],at={key:0,class:"dropdown-menu show position-absolute w-100",style:{top:"100%","z-index":"1000","max-height":"200px","overflow-y":"auto"}},ut=["onMousedown"],it=["onInput"],rt=["onInput"],dt=["onInput"],ct=["onInput"],vt=["onClick"],pt=["onClick"],mt={class:"font-bold"},bt={class:"font-bold"},gt={__name:"Editable",setup(yt){const q=G({}),a=c([["","","","","",""]]),f=c([]),b=c(!0),u=c({}),i=c({}),g=c(null),W=()=>{b.value=!b.value},p=(o,t,s)=>{let n=s.target.innerText;[2,4,5].includes(t)&&(n=parseFloat(n),isNaN(n)&&(n=0)),a.value[o][t]=n},O=async(o,t)=>{const s=t.target.value;if(a.value[o][1]=s,g.value&&clearTimeout(g.value),!s.trim()){i.value[o]=!1,u.value[o]=[];return}g.value=setTimeout(async()=>{try{const n=await I.get("/hsn/search",{params:{q:s}});u.value[o]=n.data,i.value[o]=!0}catch(n){console.error("Error searching HSN codes:",n),u.value[o]=[]}},300)},w=(o,t)=>{a.value[o][1]=t.code,i.value[o]=!1,u.value[o]=[]},z=o=>{setTimeout(()=>{i.value[o]=!1},150)},m=o=>{const t=window.getSelection();if(!t.rangeCount)return;const s=t.getRangeAt(0);o.target.dataset.cursorStart=s.startOffset},A=o=>{const t=["","","","","",""];a.value.splice(o+1,0,t)},M=o=>{if(a.value.length>1){a.value.splice(o,1),delete u.value[o],delete i.value[o];const t={},s={};a.value.forEach((n,e)=>{u.value[e+(e>=o?1:0)]&&(t[e]=u.value[e+(e>=o?1:0)]),i.value[e+(e>=o?1:0)]&&(s[e]=i.value[e+(e>=o?1:0)])}),u.value=t,i.value=s}},_=o=>{const t=parseFloat(a.value[o][2])||0,s=parseFloat(a.value[o][5])||0;return(t*s).toFixed(2)},h=()=>a.value.reduce((o,t,s)=>o+parseFloat(_(s)),0).toFixed(2),E=()=>a.value.reduce((o,t)=>o+(parseFloat(t[4])||0),0).toFixed(2),L=()=>{var B,T,k,F,N,S,V,R,H,D;const o=((B=document.getElementById("invoice_no"))==null?void 0:B.value)||"",t=((T=document.getElementById("customer"))==null?void 0:T.value)||"",s=((k=document.getElementById("company"))==null?void 0:k.value)||"",n=((F=document.getElementById("vehical_no"))==null?void 0:F.value)||"",e=((N=document.getElementById("delivery_in_days"))==null?void 0:N.value)||"",C=((S=document.getElementById("customer_name"))==null?void 0:S.value)||"",P=((V=document.getElementById("mobile"))==null?void 0:V.value)||"",Q=((R=document.getElementById("address"))==null?void 0:R.value)||"",U=((H=document.getElementById("email"))==null?void 0:H.value)||"",j=((D=document.getElementById("gst"))==null?void 0:D.value)||"";f.value[0]={invoice:o,customer:t,company:s,vehical_no:n,delivery_in_days:e,totalWeight:E(),totalTaxableValue:h(),customer_name:C,mobile:P,address:Q,email:U,gst:j},q.post(route("performa.customer.store.bill",{invoicedata:a.value,invoicedetails:f.value}),{preserveScroll:!0})};return(o,t)=>(r(),d(y,null,[l("div",{class:"mt-5 bg-purple-700 rounded-md position-relative py-2 px-3"},[t[6]||(t[6]=l("h2",{class:"text-sm font-medium text-center text-white font-weight-bolder mb-0"}," INVOICE ",-1)),l("span",{class:"text-white cursor-pointer top-2 right-3 position-absolute",onClick:W},[...t[5]||(t[5]=[l("i",{class:"fa-solid fa-bullseye fa-lg"},null,-1)])])]),J(Y,{name:"slide-fade"},{default:X(()=>[b.value?(r(),d("div",tt,[l("div",et,[l("table",lt,[t[13]||(t[13]=l("thead",{class:"table-dark"},[l("tr",null,[l("th",null,"S.NO."),l("th",null,"Description of Product"),l("th",null,"HSN Code"),l("th",null,"Quantity"),l("th",null,"Unit"),l("th",null,"Weight"),l("th",null,"Rate"),l("th",null,"Taxable Value"),l("th",null,"Action")])],-1)),l("tbody",null,[(r(!0),d(y,null,K(a.value,(s,n)=>(r(),d("tr",{key:n},[l("td",null,v(n+1),1),l("td",{contenteditable:"",onInput:e=>p(n,0,e),onKeydown:t[0]||(t[0]=e=>m(e))},null,40,ot),l("td",nt,[l("input",{type:"text",value:s[1],onInput:e=>O(n,e),onFocus:e=>i.value[n]=!0,onBlur:e=>z(n),class:"form-control border-0 p-1",placeholder:"Enter HSN Code",autocomplete:"off"},null,40,st),i.value[n]&&u.value[n]&&u.value[n].length>0?(r(),d("div",at,[(r(!0),d(y,null,K(u.value[n],e=>(r(),d("div",{key:e.code,onMousedown:C=>w(n,e),class:"dropdown-item cursor-pointer hover-item",style:{"font-size":"12px",padding:"8px 12px"}},[l("strong",null,v(e.code),1),Z(" - "+v(e.description),1)],40,ut))),128))])):$("",!0)]),l("td",{contenteditable:"",onInput:e=>p(n,2,e),onKeydown:t[1]||(t[1]=e=>m(e))},null,40,it),l("td",{contenteditable:"",onInput:e=>p(n,3,e),onKeydown:t[2]||(t[2]=e=>m(e))},null,40,rt),l("td",{contenteditable:"",onInput:e=>p(n,4,e),onKeydown:t[3]||(t[3]=e=>m(e))},null,40,dt),l("td",{contenteditable:"",onInput:e=>p(n,5,e),onKeydown:t[4]||(t[4]=e=>m(e))},null,40,ct),l("td",null,v(_(n)),1),l("td",null,[n===a.value.length-1?(r(),d("span",{key:0,class:"cursor-pointer badge rounded-pill text-bg-primary",onClick:e=>A(n)},[...t[7]||(t[7]=[l("i",{class:"fa fa-plus","aria-hidden":"true"},null,-1)])],8,vt)):(r(),d("span",{key:1,class:"cursor-pointer badge rounded-pill text-bg-danger",onClick:e=>M(n)},[...t[8]||(t[8]=[l("i",{class:"fa fa-minus","aria-hidden":"true"},null,-1)])],8,pt))])]))),128)),l("tr",null,[t[9]||(t[9]=l("td",{colspan:"4"},null,-1)),t[10]||(t[10]=l("td",{class:"font-bold"},"Total Weight:",-1)),l("td",mt,v(E()),1),t[11]||(t[11]=l("td",{class:"font-bold"},"Total:",-1)),l("td",bt,v(h()),1),t[12]||(t[12]=l("td",null,null,-1))])])])]),l("button",{class:"text-white btn btn-info text-bold mt-3",onClick:L}," Submit ")])):$("",!0)]),_:1})],64))}},ht=x(gt,[["__scopeId","data-v-c474b9f0"]]);export{ht as default};
