import{T as R,p as c,s as W,o as r,c as d,b as t,a as $,w as O,q as z,F as _,x as H,t as v,d as j,f as k,y as A}from"./app-52e465e7.js";import{_ as P}from"./_plugin-vue_export-helper-c27b6911.js";const Q={key:0},U={class:"-mt-4 rounded-lg shadow table-responsive"},G={class:"table table-bordered"},J=["data-row","innerHTML","onBlur"],K={class:"position-relative"},X=["value","onInput","onFocus","onBlur"],Y={key:0,class:"dropdown-menu show position-absolute w-100",style:{top:"100%","z-index":"1000","max-height":"200px","overflow-y":"auto"}},Z=["onMousedown"],w=["data-row","innerHTML","onBlur"],x=["data-row","innerHTML","onBlur"],I=["data-row","innerHTML","onBlur"],tt=["data-row","innerHTML","onBlur"],et=["onClick"],lt={class:"font-bold"},at={class:"font-bold"},ot={__name:"Editbilldata",props:{invoiceitem:Object},setup(C){const M=R({}),b=C,s=c([]),g=c([]),h=c(!0),u=c({}),i=c({}),f=c(null);W(()=>{b.invoiceitem?s.value=b.invoiceitem.map(e=>[e.desc_product,e.hsn_code,e.quantity,e.unit,e.weight,e.rate]):s.value=[["","","","","",""]]});const p=(e,l,n)=>{let a=n.target.innerText.trim();[2,4,5].includes(l)&&(a=parseFloat(a)||0),s.value[e][l]=a},F=async(e,l)=>{const n=l.target.value;if(s.value[e][1]=n,f.value&&clearTimeout(f.value),!n.trim()){i.value[e]=!1,u.value[e]=[];return}f.value=setTimeout(async()=>{try{const a=await A.get("/hsn/search",{params:{q:n}});u.value[e]=a.data,i.value[e]=!0}catch(a){console.error("Error searching HSN codes:",a),u.value[e]=[]}},300)},L=(e,l)=>{s.value[e][1]=l.code,i.value[e]=!1,u.value[e]=[]},N=e=>{setTimeout(()=>{i.value[e]=!1},150)},V=()=>{s.value.push(["","","","","",""])},E=e=>{if(s.value.length>1){s.value.splice(e,1),delete u.value[e],delete i.value[e];const l={},n={};s.value.forEach((a,o)=>{u.value[o+(o>=e?1:0)]&&(l[o]=u.value[o+(o>=e?1:0)]),i.value[o+(o>=e?1:0)]&&(n[o]=i.value[o+(o>=e?1:0)])}),u.value=l,i.value=n}},S=e=>e+1,y=e=>{const l=parseFloat(s.value[e][2])||0,n=parseFloat(s.value[e][5])||0;return(l*n).toFixed(2)},T=()=>s.value.reduce((e,l,n)=>e+parseFloat(y(n)),0).toFixed(2),B=()=>s.value.reduce((e,l)=>e+(parseFloat(l[4])||0),0).toFixed(2),q=()=>{var n,a,o,m;const e=((n=document.getElementById("invoice_no"))==null?void 0:n.value)||"",l=((a=document.getElementById("vehical_no"))==null?void 0:a.value)||"";g.value[0]={invoice:e,vehical_no:l,totalWeight:B(),totalTaxableValue:T()},M.post(route("customer.bill.update",{invoicedata:s.value,invoice_id:(m=(o=b.invoiceitem)==null?void 0:o[0])==null?void 0:m.invoice_id,invoicedetails:g.value}),{preserveScroll:!0})},D=()=>{h.value=!h.value};return(e,l)=>(r(),d(_,null,[t("div",{class:"mt-5 bg-purple-700 rounded-md position-relative py-2 px-3"},[l[1]||(l[1]=t("h2",{class:"text-sm font-medium text-center text-white font-weight-bolder mb-0"}," INVOICE ",-1)),t("span",{class:"text-white cursor-pointer top-2 right-3 position-absolute",onClick:D},[...l[0]||(l[0]=[t("i",{class:"fa-solid fa-bullseye"},null,-1)])])]),$(z,{name:"slide-fade"},{default:O(()=>[h.value?(r(),d("div",Q,[t("div",U,[t("table",G,[l[11]||(l[11]=t("thead",{class:"table-dark"},[t("tr",null,[t("th",null,"S.NO."),t("th",null,"Description of Product"),t("th",null,"HSN Code"),t("th",null,"Quantity"),t("th",null,"Unit"),t("th",null,"Weight"),t("th",null,"Rate"),t("th",null,"Taxable Value"),t("th",null,"Action")])],-1)),t("tbody",null,[(r(!0),d(_,null,H(s.value,(n,a)=>(r(),d("tr",{key:a},[t("td",null,v(S(a)),1),t("td",{contenteditable:"true","data-row":a,"data-cell":0,innerHTML:n[0],onBlur:o=>p(a,0,o)},null,40,J),t("td",K,[t("input",{type:"text",value:n[1],onInput:o=>F(a,o),onFocus:o=>i.value[a]=!0,onBlur:o=>N(a),class:"form-control border-0 p-1",placeholder:"Enter HSN Code",autocomplete:"off"},null,40,X),i.value[a]&&u.value[a]&&u.value[a].length>0?(r(),d("div",Y,[(r(!0),d(_,null,H(u.value[a],o=>(r(),d("div",{key:o.code,onMousedown:m=>L(a,o),class:"dropdown-item cursor-pointer hover-item",style:{"font-size":"12px",padding:"8px 12px"}},[t("strong",null,v(o.code),1),j(" - "+v(o.description),1)],40,Z))),128))])):k("",!0)]),t("td",{contenteditable:"true","data-row":a,"data-cell":2,innerHTML:n[2],onBlur:o=>p(a,2,o)},null,40,w),t("td",{contenteditable:"true","data-row":a,"data-cell":3,innerHTML:n[3],onBlur:o=>p(a,3,o)},null,40,x),t("td",{contenteditable:"true","data-row":a,"data-cell":4,innerHTML:n[4],onBlur:o=>p(a,4,o)},null,40,I),t("td",{contenteditable:"true","data-row":a,"data-cell":5,innerHTML:n[5],onBlur:o=>p(a,5,o)},null,40,tt),t("td",null,v(y(a)),1),t("td",null,[a===s.value.length-1?(r(),d("span",{key:0,class:"cursor-pointer badge rounded-pill text-bg-primary",onClick:V},[...l[2]||(l[2]=[t("i",{class:"fa fa-plus","aria-hidden":"true"},null,-1)])])):(r(),d("span",{key:1,class:"cursor-pointer badge rounded-pill text-bg-danger",onClick:o=>E(a)},[...l[3]||(l[3]=[t("i",{class:"fa fa-minus","aria-hidden":"true"},null,-1)])],8,et))])]))),128)),t("tr",null,[l[4]||(l[4]=t("td",null,null,-1)),l[5]||(l[5]=t("td",null,null,-1)),l[6]||(l[6]=t("td",null,null,-1)),l[7]||(l[7]=t("td",null,null,-1)),l[8]||(l[8]=t("td",{class:"font-bold"},"Total Weight:",-1)),t("td",lt,v(B()),1),l[9]||(l[9]=t("td",{class:"font-bold"},"Total:",-1)),t("td",at,v(T()),1),l[10]||(l[10]=t("td",null,null,-1))])])])]),t("button",{class:"text-white btn btn-info text-bold",onClick:q}," Submit ")])):k("",!0)]),_:1})],64))}},ut=P(ot,[["__scopeId","data-v-390d4262"]]);export{ut as default};
