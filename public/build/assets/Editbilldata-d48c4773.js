import{T as $,p as c,s as O,o as r,c as d,b as t,a as z,w as j,q as A,F as m,x as C,t as v,d as P,f as M,y as Q}from"./app-5e77b17f.js";import{_ as U}from"./_plugin-vue_export-helper-c27b6911.js";const G={key:0},J={class:"rounded-lg shadow table-responsive"},K={class:"table table-bordered"},X=["data-row","innerHTML","onBlur"],Y={class:"position-relative"},Z=["value","onInput","onFocus","onBlur"],w={key:0,class:"dropdown-menu show position-absolute w-100",style:{top:"100%","z-index":"1000","max-height":"200px","overflow-y":"auto"}},x=["onMousedown"],I=["data-row","innerHTML","onBlur"],tt=["data-row","innerHTML","onBlur"],et=["data-row","innerHTML","onBlur"],lt=["data-row","innerHTML","onBlur"],at=["onClick"],ot={class:"font-bold"},nt={class:"font-bold"},st={__name:"Editbilldata",props:{invoiceitem:Object},setup(F){const E=$({}),f=F,s=c([]),g=c([]),b=c(!0),u=c({}),i=c({}),h=c(null);O(()=>{f.invoiceitem?s.value=f.invoiceitem.map(e=>[e.desc_product,e.hsn_code,e.quantity,e.unit,e.weight,e.rate]):s.value=[["","","","","",""]]});const p=(e,l,n)=>{let a=n.target.innerText.trim();[2,4,5].includes(l)&&(a=parseFloat(a)||0),s.value[e][l]=a},L=async(e,l)=>{const n=l.target.value;if(s.value[e][1]=n,h.value&&clearTimeout(h.value),!n.trim()){i.value[e]=!1,u.value[e]=[];return}h.value=setTimeout(async()=>{try{const a=await Q.get("/hsn/search",{params:{q:n}});u.value[e]=a.data,i.value[e]=!0}catch(a){console.error("Error searching HSN codes:",a),u.value[e]=[]}},300)},N=(e,l)=>{s.value[e][1]=l.code,i.value[e]=!1,u.value[e]=[]},V=e=>{setTimeout(()=>{i.value[e]=!1},150)},S=()=>{s.value.push(["","","","","",""])},q=e=>{if(s.value.length>1){s.value.splice(e,1),delete u.value[e],delete i.value[e];const l={},n={};s.value.forEach((a,o)=>{u.value[o+(o>=e?1:0)]&&(l[o]=u.value[o+(o>=e?1:0)]),i.value[o+(o>=e?1:0)]&&(n[o]=i.value[o+(o>=e?1:0)])}),u.value=l,i.value=n}},D=e=>e+1,y=e=>{const l=parseFloat(s.value[e][2])||0,n=parseFloat(s.value[e][5])||0;return(l*n).toFixed(2)},T=()=>s.value.reduce((e,l,n)=>e+parseFloat(y(n)),0).toFixed(2),B=()=>s.value.reduce((e,l)=>e+(parseFloat(l[4])||0),0).toFixed(2),R=()=>{var a,o,_,H,k;const e=((a=document.getElementById("invoice_no"))==null?void 0:a.value)||"",l=((o=document.getElementById("vehical_no"))==null?void 0:o.value)||"",n=((_=document.getElementById("delivery_in_days"))==null?void 0:_.value)||"";g.value[0]={invoice:e,vehical_no:l,delivery_in_days:n,totalWeight:B(),totalTaxableValue:T()},E.post(route("performa.customer.bill.update",{invoicedata:s.value,invoice_id:(k=(H=f.invoiceitem)==null?void 0:H[0])==null?void 0:k.invoice_id,invoicedetails:g.value}),{preserveScroll:!0})},W=()=>{b.value=!b.value};return(e,l)=>(r(),d(m,null,[t("div",{class:"mt-5 bg-purple-700 rounded-md position-relative py-2 px-3"},[l[1]||(l[1]=t("h2",{class:"text-sm font-medium text-center text-white font-weight-bolder mb-0"}," INVOICE ",-1)),t("span",{class:"text-white cursor-pointer top-2 right-3 position-absolute",onClick:W},[...l[0]||(l[0]=[t("i",{class:"fa-solid fa-bullseye fa-lg"},null,-1)])])]),z(A,{name:"slide-fade"},{default:j(()=>[b.value?(r(),d("div",G,[t("div",J,[t("table",K,[l[11]||(l[11]=t("thead",{class:"table-dark"},[t("tr",null,[t("th",null,"S.NO."),t("th",null,"Description of Product"),t("th",null,"HSN Code"),t("th",null,"Quantity"),t("th",null,"Unit"),t("th",null,"Weight"),t("th",null,"Rate"),t("th",null,"Taxable Value"),t("th",null,"Action")])],-1)),t("tbody",null,[(r(!0),d(m,null,C(s.value,(n,a)=>(r(),d("tr",{key:a},[t("td",null,v(D(a)),1),t("td",{contenteditable:"true","data-row":a,"data-cell":0,innerHTML:n[0],onBlur:o=>p(a,0,o)},null,40,X),t("td",Y,[t("input",{type:"text",value:n[1],onInput:o=>L(a,o),onFocus:o=>i.value[a]=!0,onBlur:o=>V(a),class:"form-control border-0 p-1",placeholder:"Enter HSN Code",autocomplete:"off"},null,40,Z),i.value[a]&&u.value[a]&&u.value[a].length>0?(r(),d("div",w,[(r(!0),d(m,null,C(u.value[a],o=>(r(),d("div",{key:o.code,onMousedown:_=>N(a,o),class:"dropdown-item cursor-pointer hover-item",style:{"font-size":"12px",padding:"8px 12px"}},[t("strong",null,v(o.code),1),P(" - "+v(o.description),1)],40,x))),128))])):M("",!0)]),t("td",{contenteditable:"true","data-row":a,"data-cell":2,innerHTML:n[2],onBlur:o=>p(a,2,o)},null,40,I),t("td",{contenteditable:"true","data-row":a,"data-cell":3,innerHTML:n[3],onBlur:o=>p(a,3,o)},null,40,tt),t("td",{contenteditable:"true","data-row":a,"data-cell":4,innerHTML:n[4],onBlur:o=>p(a,4,o)},null,40,et),t("td",{contenteditable:"true","data-row":a,"data-cell":5,innerHTML:n[5],onBlur:o=>p(a,5,o)},null,40,lt),t("td",null,v(y(a)),1),t("td",null,[a===s.value.length-1?(r(),d("span",{key:0,class:"cursor-pointer badge rounded-pill text-bg-primary",onClick:S},[...l[2]||(l[2]=[t("i",{class:"fa fa-plus","aria-hidden":"true"},null,-1)])])):(r(),d("span",{key:1,class:"cursor-pointer badge rounded-pill text-bg-danger",onClick:o=>q(a)},[...l[3]||(l[3]=[t("i",{class:"fa fa-minus","aria-hidden":"true"},null,-1)])],8,at))])]))),128)),t("tr",null,[l[4]||(l[4]=t("td",null,null,-1)),l[5]||(l[5]=t("td",null,null,-1)),l[6]||(l[6]=t("td",null,null,-1)),l[7]||(l[7]=t("td",null,null,-1)),l[8]||(l[8]=t("td",{class:"font-bold"},"Total Weight:",-1)),t("td",ot,v(B()),1),l[9]||(l[9]=t("td",{class:"font-bold"},"Total:",-1)),t("td",nt,v(T()),1),l[10]||(l[10]=t("td",null,null,-1))])])])]),t("button",{class:"text-white btn btn-info text-bold",onClick:R}," Submit ")])):M("",!0)]),_:1})],64))}},rt=U(st,[["__scopeId","data-v-dc5c2ff4"]]);export{rt as default};
